dwipreproc_cust: [03;32m[0m
dwipreproc_cust: [03;32mNote that this script makes use of commands / algorithms that have relevant articles for citation; INCLUDING FROM EXTERNAL SOFTWARE PACKAGES. Please consult the help page (-help option) for more information.[0m
dwipreproc_cust: [03;32m[0m
dwipreproc_cust: [03;32mGenerated temporary directory: /mnt/lustre/working/lab_michaebr/alistaiP/Park/Diff/Patient_063/preproc/dwipreproc_cust-tmp-C16973/[0m
[03;34mCommand:[0m mrconvert /mnt/lustre/working/lab_michaebr/alistaiP/Park/Diff/Patient_063/preproc/rawdataAPdn.mif /mnt/lustre/working/lab_michaebr/alistaiP/Park/Diff/Patient_063/preproc/dwipreproc_cust-tmp-C16973/series.mif
[03;34mCommand:[0m mrconvert /mnt/lustre/working/lab_michaebr/alistaiP/Park/Diff/Patient_063/preproc/AP7b0s.mif /mnt/lustre/working/lab_michaebr/alistaiP/Park/Diff/Patient_063/preproc/dwipreproc_cust-tmp-C16973/pair1.mif
[03;34mCommand:[0m mrconvert /mnt/lustre/working/lab_michaebr/alistaiP/Park/Diff/Patient_063/preproc/rawdataPAdn.mif /mnt/lustre/working/lab_michaebr/alistaiP/Park/Diff/Patient_063/preproc/dwipreproc_cust-tmp-C16973/pair2.mif
dwipreproc_cust: [03;32mChanging to temporary directory (/mnt/lustre/working/lab_michaebr/alistaiP/Park/Diff/Patient_063/preproc/dwipreproc_cust-tmp-C16973/)[0m
dwipreproc_cust: [03;32mCommand: '/software/mrtrix3/mrtrix3-AP/release/bin/mrinfo series.mif -size' (piping data to local storage)[0m
dwipreproc_cust: [03;32mResult: 128 128 90 103[0m
dwipreproc_cust: [03;32mCommand: '/software/mrtrix3/mrtrix3-AP/release/bin/mrinfo series.mif -dwgrad' (piping data to local storage)[0m
dwipreproc_cust: [03;32mResult:          0          0          0          0
         0          0          0          0
         0          0          0          0
         1 0.00066968 0.00033456       3000
-0.0256591  -0.746763   0.664595       3000
 0.0033433   0.520352  -0.853945       3000
 -0.271934   0.829896    0.48716       3000
  0.651064    0.40829   0.639855       3000
 -0.507889   0.263656  -0.820082       3000
 -0.958928   0.282377 -0.0268229       3000
 -0.534403   0.384083   0.752924       3000
  0.316929   0.136758   0.938538       3000
         0          0          0          0
 -0.505482  -0.593071   0.626701       3000
 -0.600873  0.0987154   0.793226       3000
  0.954313  -0.157774   0.253759       3000
  0.526525  -0.745034  -0.409507       3000
 -0.193334  -0.926113  -0.323941       3000
  0.364337   0.925645   0.102181       3000
 -0.258466   0.931777  -0.254924       3000
 -0.022677   0.513571   0.857747       3000
  0.613056   0.788993  0.0406502       3000
         0          0          0          0
 -0.873602  0.0337041  -0.485473       3000
  0.744006   -0.23388  -0.625904       3000
 -0.487444   0.678848  -0.549148       3000
  0.450438  -0.891622  0.0459944       3000
  0.662725  -0.433687     0.6105       3000
  0.853555   0.240428    0.46221       3000
  0.438968   -0.50857   0.740719       3000
 -0.958183  -0.141581   0.248676       3000
  0.703297  -0.596531   0.386683       3000
         0          0          0          0
  0.387466  -0.183835  -0.903368       3000
  -0.14284   -0.68394  -0.715418       3000
  0.801464  -0.597391 -0.0279285       3000
  0.288795   -0.13336   0.948057       3000
 -0.963051  -0.132107  -0.234692       3000
  0.150868  -0.698922  -0.699105       3000
  0.016226  -0.983643   0.179396       3000
  0.375722  -0.898528  -0.226892       3000
 -0.667442   0.730075  -0.146669       3000
         0          0          0          0
  0.290178   -0.46902  -0.834157       3000
  0.723066  -0.159693   0.672067       3000
 -0.715617  -0.660867  -0.226157       3000
 -0.427898  -0.584091   -0.68974       3000
 -0.958428  -0.284862  0.0163959       3000
 -0.493487  -0.299733  -0.816475       3000
  0.893543   0.401197   0.201546       3000
 -0.202232   0.978696  0.0354524       3000
  0.230656   0.966802  -0.109967       3000
         0          0          0          0
 -0.738258   0.602618   0.303028       3000
 -0.843557    0.33952     0.4161       3000
 -0.104845  -0.287779  -0.951941       3000
 -0.238991   0.401758   -0.88401       3000
  -0.61176   0.779024   0.137373       3000
  0.266623   0.460413   0.846718       3000
  0.657787  -0.516443  -0.548273       3000
 -0.256984   -0.89661   0.360624       3000
  0.248891  -0.822365   0.511634       3000
         0          0          0          0
  0.571883   0.661455   0.485209       3000
 0.0218651   -0.25051   0.967867       3000
  0.224882   0.323169  -0.919233       3000
  -0.83771   0.324854   -0.43899       3000
 -0.860516   0.467174  -0.203127       3000
  0.487438  -0.811475   0.322355       3000
 -0.105977   0.948304   0.299147       3000
  0.542837  0.0135078   0.839729       3000
 -0.250518  -0.578938   0.775933       3000
         0          0          0          0
  -0.22888 -0.0413921   0.972574       3000
 -0.215237   0.655297  -0.724057       3000
  0.961431  -0.148998  -0.231195       3000
  0.310783   0.790729   0.527411       3000
 -0.870659  -0.431242   0.236607       3000
  0.846034    0.26614  -0.461948       3000
  0.893485  -0.414734  -0.172278       3000
 -0.703309  -0.679622   0.208496       3000
 -0.667608  -0.352989   0.655514       3000
         0          0          0          0
  0.517358   0.751024  -0.410248       3000
 -0.720144  -0.137635  -0.680036       3000
-0.0410512 -0.0238847  -0.998872       3000
  0.826409    0.56306 0.00333378       3000
  0.453874   0.388092  -0.802112       3000
 -0.880027  0.0387572    0.47334       3000
 -0.148038    0.24973   0.956932       3000
  -0.76731  -0.486691  -0.417573       3000
 -0.479763  -0.130433   0.867649       3000
         0          0          0          0
  0.718057   0.534717  -0.445502       3000
 -0.481245  -0.823882  -0.299368       3000
  0.282197   0.763934  -0.580319       3000
 0.0178516   0.848862   0.528313       3000
-0.0654007  -0.992843 -0.0999298       3000
 -0.420631   0.636394   0.646585       3000
   0.73468  0.0999495   -0.67101       3000
0.00044749   0.898167  -0.439655       3000
 -0.475871  -0.862832   0.170493       3000
         0          0          0          0[0m
dwipreproc_cust: [03;32mCommand: '/software/mrtrix3/mrtrix3-AP/release/bin/mrinfo series.mif -stride' (piping data to local storage)[0m
dwipreproc_cust: [03;32mResult: 1 2 3 4[0m
dwipreproc_cust: [03;32mCommand: '/software/mrtrix3/mrtrix3-AP/release/bin/mrinfo pair1.mif -size' (piping data to local storage)[0m
dwipreproc_cust: [03;32mResult: 128 128 90 7[0m
dwipreproc_cust: [03;32mCommand: '/software/mrtrix3/mrtrix3-AP/release/bin/mrinfo pair2.mif -size' (piping data to local storage)[0m
dwipreproc_cust: [03;32mResult: 128 128 90 7[0m
[03;34mCommand:[0m mrconvert series.mif dwi_pre_topup.nii -stride -1,+2,+3,+4
[03;34mCommand:[0m mrcat pair1.mif pair2.mif - -axis 3 | mrconvert - topup_in.nii -stride -1,+2,+3,+4
dwipreproc_cust: [03;32mCommand: '/software/mrtrix3/mrtrix3-AP/release/bin/mrinfo pair1.mif -size' (piping data to local storage)[0m
dwipreproc_cust: [03;32mResult: 128 128 90 7[0m
dwipreproc_cust: [03;32mCommand: '/software/mrtrix3/mrtrix3-AP/release/bin/mrinfo pair2.mif -size' (piping data to local storage)[0m
dwipreproc_cust: [03;32mResult: 128 128 90 7[0m
dwipreproc_cust: [03;32mCreating phase-encoding configuration file[0m
[03;34mCommand:[0m topup --imain=topup_in.nii --datain=config.txt --out=field --fout=field_map.nii.gz --config=/software/fsl/fsl-5.0.9_eddy/fsl/etc/flirtsch/b02b0.cnf
[03;34mCommand:[0m applytopup --imain=dwi_pre_topup.nii --datain=config.txt --inindex=1 --topup=field --out=dwi_post_topup.nii.gz --method=jac
[03;34mCommand:[0m mrconvert series.mif - -stride -1,+2,+3,+4 | mrinfo - -export_grad_fsl bvecs bvals
[03;34mCommand:[0m mrconvert dwi_post_topup.nii.gz -fslgrad bvecs bvals - | dwi2mask - - | maskfilter - dilate - | mrconvert - mask.nii -datatype float32 -stride -1,+2,+3
[03;34mCommand:[0m eddy_openmp --imain=dwi_pre_topup.nii --mask=mask.nii --index=indices.txt --acqp=config.txt --bvecs=bvecs --bvals=bvals --repol --topup=field --out=dwi_post_eddy
[03;34mCommand:[0m mrconvert dwi_post_eddy.nii.gz result.mif -stride 1,2,3,4 -fslgrad dwi_post_eddy.eddy_rotated_bvecs bvals
[03;34mCommand:[0m mrconvert result.mif /mnt/lustre/working/lab_michaebr/alistaiP/Park/Diff/Patient_063/preproc/eddycorr.mif -export_grad_mrtrix /mnt/lustre/working/lab_michaebr/alistaiP/Park/Diff/Patient_063/preproc/adjencoding.b
dwipreproc_cust: [03;32mChanging back to original directory (/mnt/lustre/working/lab_michaebr/alistaiP/Park/Diff/Patient_063/preproc)[0m
dwipreproc_cust: [03;32mDeleting temporary directory /mnt/lustre/working/lab_michaebr/alistaiP/Park/Diff/Patient_063/preproc/dwipreproc_cust-tmp-C16973/[0m
dwibiascorrect: [03;32m[0m
dwibiascorrect: [03;32mNote that this script makes use of commands / algorithms that have relevant articles for citation; INCLUDING FROM EXTERNAL SOFTWARE PACKAGES. Please consult the help page (-help option) for more information.[0m
dwibiascorrect: [03;32m[0m
dwibiascorrect: [03;32mGenerated temporary directory: /tmp/dwibiascorrect-tmp-31XP72/[0m
[03;34mCommand:[0m mrconvert /mnt/lustre/working/lab_michaebr/alistaiP/Park/Diff/Patient_063/preproc/eddycorr.mif /tmp/dwibiascorrect-tmp-31XP72/in.mif
[03;34mCommand:[0m mrconvert /mnt/lustre/working/lab_michaebr/alistaiP/Park/Diff/Patient_063/preproc/eddymeanb0bet_mask.nii.gz /tmp/dwibiascorrect-tmp-31XP72/mask.mif
dwibiascorrect: [03;32mChanging to temporary directory (/tmp/dwibiascorrect-tmp-31XP72/)[0m
[03;34mCommand:[0m dwiextract in.mif - -bzero | mrmath - mean mean_bzero.mif -axis 3
[03;34mCommand:[0m mrcalc mean_bzero.mif mask.mif -mult - | mrconvert - mean_bzero_masked.nii -stride -1,+2,+3
[03;34mCommand:[0m fast -t 2 -o fast -n 3 -b mean_bzero_masked.nii
[03;34mCommand:[0m mrcalc in.mif fast_bias.nii.gz -div result.mif
[03;34mCommand:[0m mrconvert result.mif /mnt/lustre/working/lab_michaebr/alistaiP/Park/Diff/Patient_063/preproc/biascorr.mif
dwibiascorrect: [03;32mChanging back to original directory (/mnt/lustre/working/lab_michaebr/alistaiP/Park/Diff/Patient_063/preproc)[0m
dwibiascorrect: [03;32mDeleting temporary directory /tmp/dwibiascorrect-tmp-31XP72/[0m
Extracting mean of the b=0 shell.
Extracting mean of the b=3000 shell.
Extracting mean of the b=0 shell.
Extracting mean of the b=3000 shell.
61710
labelsgmfix: [03;32m[0m
labelsgmfix: [03;32mNote that this script makes use of commands / algorithms that have relevant articles for citation; INCLUDING FROM EXTERNAL SOFTWARE PACKAGES. Please consult the help page (-help option) for more information.[0m
labelsgmfix: [03;32m[0m
labelsgmfix: [03;32mGenerated temporary directory: /tmp/labelsgmfix-tmp-ZUHP7N/[0m
[03;34mCommand:[0m mrconvert /mnt/lustre/working/lab_michaebr/alistaiP/Park/Diff/Patient_063/preproc/parctempstr.nii /tmp/labelsgmfix-tmp-ZUHP7N/parc.mif
[03;34mCommand:[0m mrconvert /mnt/lustre/working/lab_michaebr/alistaiP/Park/Diff/Patient_063/preproc/brainFS.nii /tmp/labelsgmfix-tmp-ZUHP7N/T1.nii -stride -1,+2,+3
labelsgmfix: [03;32mChanging to temporary directory (/tmp/labelsgmfix-tmp-ZUHP7N/)[0m
[03;34mCommand:[0m run_first_all -s R_Thal,L_Puta,R_Caud,R_Hipp,L_Amyg,R_Pall,R_Amyg,L_Caud,L_Pall,L_Thal,L_Hipp,R_Accu,L_Accu,R_Puta -i T1.nii -b -o first
[03;34mCommand:[0m mrcalc parc.mif 0 -min sgm.mif
[03;34mCommand:[0m meshconvert first-R_Thal_first.vtk transformed.vtk -transform_first2real T1.nii
[03;34mCommand:[0m mesh2pve transformed.vtk parc.mif - | mrthreshold - R_Thal_mask.mif -abs 0.5
[03;34mCommand:[0m mrcalc R_Thal_mask.mif 6 sgm.mif -if sgm_new.mif
[03;34mCommand:[0m meshconvert first-L_Puta_first.vtk transformed.vtk -transform_first2real T1.nii
[03;34mCommand:[0m mesh2pve transformed.vtk parc.mif - | mrthreshold - L_Puta_mask.mif -abs 0.5
[03;34mCommand:[0m mrcalc L_Puta_mask.mif 3 sgm.mif -if sgm_new.mif
[03;34mCommand:[0m meshconvert first-R_Caud_first.vtk transformed.vtk -transform_first2real T1.nii
[03;34mCommand:[0m mesh2pve transformed.vtk parc.mif - | mrthreshold - R_Caud_mask.mif -abs 0.5
[03;34mCommand:[0m mrcalc R_Caud_mask.mif 7 sgm.mif -if sgm_new.mif
[03;34mCommand:[0m meshconvert first-R_Hipp_first.vtk transformed.vtk -transform_first2real T1.nii
[03;34mCommand:[0m mesh2pve transformed.vtk parc.mif - | mrthreshold - R_Hipp_mask.mif -abs 0.5
[03;34mCommand:[0m mrcalc R_Hipp_mask.mif 13 sgm.mif -if sgm_new.mif
[03;34mCommand:[0m meshconvert first-L_Amyg_first.vtk transformed.vtk -transform_first2real T1.nii
[03;34mCommand:[0m mesh2pve transformed.vtk parc.mif - | mrthreshold - L_Amyg_mask.mif -abs 0.5
[03;34mCommand:[0m mrcalc L_Amyg_mask.mif 12 sgm.mif -if sgm_new.mif
[03;34mCommand:[0m meshconvert first-R_Pall_first.vtk transformed.vtk -transform_first2real T1.nii
[03;34mCommand:[0m mesh2pve transformed.vtk parc.mif - | mrthreshold - R_Pall_mask.mif -abs 0.5
[03;34mCommand:[0m mrcalc R_Pall_mask.mif 9 sgm.mif -if sgm_new.mif
[03;34mCommand:[0m meshconvert first-R_Amyg_first.vtk transformed.vtk -transform_first2real T1.nii
[03;34mCommand:[0m mesh2pve transformed.vtk parc.mif - | mrthreshold - R_Amyg_mask.mif -abs 0.5
[03;34mCommand:[0m mrcalc R_Amyg_mask.mif 14 sgm.mif -if sgm_new.mif
[03;34mCommand:[0m meshconvert first-L_Caud_first.vtk transformed.vtk -transform_first2real T1.nii
[03;34mCommand:[0m mesh2pve transformed.vtk parc.mif - | mrthreshold - L_Caud_mask.mif -abs 0.5
[03;34mCommand:[0m mrcalc L_Caud_mask.mif 2 sgm.mif -if sgm_new.mif
[03;34mCommand:[0m meshconvert first-L_Pall_first.vtk transformed.vtk -transform_first2real T1.nii
[03;34mCommand:[0m mesh2pve transformed.vtk parc.mif - | mrthreshold - L_Pall_mask.mif -abs 0.5
[03;34mCommand:[0m mrcalc L_Pall_mask.mif 4 sgm.mif -if sgm_new.mif
[03;34mCommand:[0m meshconvert first-L_Thal_first.vtk transformed.vtk -transform_first2real T1.nii
[03;34mCommand:[0m mesh2pve transformed.vtk parc.mif - | mrthreshold - L_Thal_mask.mif -abs 0.5
[03;34mCommand:[0m mrcalc L_Thal_mask.mif 1 sgm.mif -if sgm_new.mif
[03;34mCommand:[0m meshconvert first-L_Hipp_first.vtk transformed.vtk -transform_first2real T1.nii
[03;34mCommand:[0m mesh2pve transformed.vtk parc.mif - | mrthreshold - L_Hipp_mask.mif -abs 0.5
[03;34mCommand:[0m mrcalc L_Hipp_mask.mif 11 sgm.mif -if sgm_new.mif
[03;34mCommand:[0m meshconvert first-R_Accu_first.vtk transformed.vtk -transform_first2real T1.nii
[03;34mCommand:[0m mesh2pve transformed.vtk parc.mif - | mrthreshold - R_Accu_mask.mif -abs 0.5
[03;34mCommand:[0m mrcalc R_Accu_mask.mif 10 sgm.mif -if sgm_new.mif
[03;34mCommand:[0m meshconvert first-L_Accu_first.vtk transformed.vtk -transform_first2real T1.nii
[03;34mCommand:[0m mesh2pve transformed.vtk parc.mif - | mrthreshold - L_Accu_mask.mif -abs 0.5
[03;34mCommand:[0m mrcalc L_Accu_mask.mif 5 sgm.mif -if sgm_new.mif
[03;34mCommand:[0m meshconvert first-R_Puta_first.vtk transformed.vtk -transform_first2real T1.nii
[03;34mCommand:[0m mesh2pve transformed.vtk parc.mif - | mrthreshold - R_Puta_mask.mif -abs 0.5
[03;34mCommand:[0m mrcalc R_Puta_mask.mif 8 sgm.mif -if sgm_new.mif
[03;34mCommand:[0m mrmath R_Thal_mask.mif L_Puta_mask.mif R_Caud_mask.mif R_Hipp_mask.mif L_Amyg_mask.mif R_Pall_mask.mif R_Amyg_mask.mif L_Caud_mask.mif L_Pall_mask.mif L_Thal_mask.mif L_Hipp_mask.mif R_Accu_mask.mif L_Accu_mask.mif R_Puta_mask.mif sum - | mrcalc - 1 -gt sgm_overlap_mask.mif
[03;34mCommand:[0m mrcalc sgm_overlap_mask.mif 0 sgm.mif -if sgm_masked.mif
[03;34mCommand:[0m labelconvert sgm_masked.mif /software/mrtrix3/mrtrix3-AP/scripts/data/FreeSurferSGM.txt /software/mrtrix3/mrtrix3-AP/src/connectome/tables/fs_a2009s.txt sgm_new_labels.mif
[03;34mCommand:[0m mrcalc parc.mif 83 -eq 0 parc.mif -if parc_removed.mif
[03;34mCommand:[0m mrcalc parc.mif 78 -eq 0 parc.mif -if parc_removed.mif
[03;34mCommand:[0m mrcalc parc.mif 84 -eq 0 parc.mif -if parc_removed.mif
[03;34mCommand:[0m mrcalc parc.mif 87 -eq 0 parc.mif -if parc_removed.mif
[03;34mCommand:[0m mrcalc parc.mif 81 -eq 0 parc.mif -if parc_removed.mif
[03;34mCommand:[0m mrcalc parc.mif 86 -eq 0 parc.mif -if parc_removed.mif
[03;34mCommand:[0m mrcalc parc.mif 88 -eq 0 parc.mif -if parc_removed.mif
[03;34mCommand:[0m mrcalc parc.mif 77 -eq 0 parc.mif -if parc_removed.mif
[03;34mCommand:[0m mrcalc parc.mif 79 -eq 0 parc.mif -if parc_removed.mif
[03;34mCommand:[0m mrcalc parc.mif 76 -eq 0 parc.mif -if parc_removed.mif
[03;34mCommand:[0m mrcalc parc.mif 80 -eq 0 parc.mif -if parc_removed.mif
[03;34mCommand:[0m mrcalc parc.mif 89 -eq 0 parc.mif -if parc_removed.mif
[03;34mCommand:[0m mrcalc parc.mif 82 -eq 0 parc.mif -if parc_removed.mif
[03;34mCommand:[0m mrcalc parc.mif 85 -eq 0 parc.mif -if parc_removed.mif
[03;34mCommand:[0m mrcalc sgm_new_labels.mif 0.5 -gt sgm_new_labels.mif parc.mif -if result.mif -datatype uint32
[03;34mCommand:[0m mrconvert result.mif /mnt/lustre/working/lab_michaebr/alistaiP/Park/Diff/Patient_063/preproc/parc_fixsubcort.nii
labelsgmfix: [03;32mChanging back to original directory (/mnt/lustre/working/lab_michaebr/alistaiP/Park/Diff/Patient_063/preproc)[0m
labelsgmfix: [03;32mDeleting temporary directory /tmp/labelsgmfix-tmp-ZUHP7N/[0m
tmp ./tmp.bbregister.8760
Log file is register.dat.log
Sat Mar 18 04:07:59 AEST 2017

setenv SUBJECTS_DIR /working/lab_michaebr/alistaiP/Park/FS
cd /mnt/lustre/working/lab_michaebr/alistaiP/Park/Diff/Patient_063/preproc
/software/freesurfer/freesurfer-6.0.0/bin/bbregister --s Patient_063 --mov biasmeanb0bet.nii.gz --init-fsl --reg register.dat --dti --fslmat diff2FS.mat

$Id: bbregister,v 1.75 2016/05/10 20:02:28 greve Exp $
Linux hpcnode031.adqimr.ad.lan 3.10.0-327.3.1.el7.x86_64 #1 SMP Wed Dec 9 14:09:15 UTC 2015 x86_64 x86_64 x86_64 GNU/Linux
FREESURFER_HOME /software/freesurfer/freesurfer-6.0.0
mri_convert biasmeanb0bet.nii.gz ./tmp.bbregister.8760/template.nii
mri_convert.bin biasmeanb0bet.nii.gz ./tmp.bbregister.8760/template.nii 
$Id: mri_convert.c,v 1.226 2016/02/26 16:15:24 mreuter Exp $
reading from biasmeanb0bet.nii.gz...
TR=1000.00, TE=0.00, TI=0.00, flip angle=0.00
i_ras = (0.996676, -0.0518844, -0.0628073)
j_ras = (0.0634041, 0.978122, 0.198132)
k_ras = (0.0511532, -0.201456, 0.978161)
writing to ./tmp.bbregister.8760/template.nii...
fslregister --s Patient_063 --mov ./tmp.bbregister.8760/template.nii --reg ./tmp.bbregister.8760/reg.init.dat --niters 1 --maxangle 90 --tmp ./tmp.bbregister.8760/fslregister --dof 6 --fsvol brainmask.mgz --nobetmov

Log file is ./tmp.bbregister.8760/reg.init.dat.fslregister.log

Sat Mar 18 04:07:59 AEST 2017
--s Patient_063 --mov ./tmp.bbregister.8760/template.nii --reg ./tmp.bbregister.8760/reg.init.dat --niters 1 --maxangle 90 --tmp ./tmp.bbregister.8760/fslregister --dof 6 --fsvol brainmask.mgz --nobetmov
$Id: fslregister,v 1.40 2016/02/12 21:43:15 zkaufman Exp $
hpcnode031.adqimr.ad.lan
Linux hpcnode031.adqimr.ad.lan 3.10.0-327.3.1.el7.x86_64 #1 SMP Wed Dec 9 14:09:15 UTC 2015 x86_64 x86_64 x86_64 GNU/Linux
nIters 1
--------------------------------------
/mnt/lustre/working/lab_michaebr/alistaiP/Park/Diff/Patient_063/preproc
mri_convert /working/lab_michaebr/alistaiP/Park/FS/Patient_063/mri/brainmask.mgz ./tmp.bbregister.8760/fslregister/refvol.fslregister.nii
mri_convert.bin /working/lab_michaebr/alistaiP/Park/FS/Patient_063/mri/brainmask.mgz ./tmp.bbregister.8760/fslregister/refvol.fslregister.nii 
$Id: mri_convert.c,v 1.226 2016/02/26 16:15:24 mreuter Exp $
reading from /working/lab_michaebr/alistaiP/Park/FS/Patient_063/mri/brainmask.mgz...
TR=0.00, TE=0.00, TI=0.00, flip angle=0.00
i_ras = (-1, 4.65661e-09, 3.72529e-09)
j_ras = (-3.72529e-09, 1.49012e-08, -1)
k_ras = (-9.31323e-10, 1, 0)
writing to ./tmp.bbregister.8760/fslregister/refvol.fslregister.nii...
--------------------------------------
/mnt/lustre/working/lab_michaebr/alistaiP/Park/Diff/Patient_063/preproc
mri_convert ./tmp.bbregister.8760/template.nii ./tmp.bbregister.8760/fslregister/movvol.fslregister.nii --frame 0
mri_convert.bin ./tmp.bbregister.8760/template.nii ./tmp.bbregister.8760/fslregister/movvol.fslregister.nii --frame 0 
$Id: mri_convert.c,v 1.226 2016/02/26 16:15:24 mreuter Exp $
reading from ./tmp.bbregister.8760/template.nii...
TR=1000.00, TE=0.00, TI=0.00, flip angle=0.00
i_ras = (0.996676, -0.0518844, -0.0628073)
j_ras = (0.0634041, 0.978122, 0.198132)
k_ras = (0.0511532, -0.201456, 0.978161)
keeping frame 0
writing to ./tmp.bbregister.8760/fslregister/movvol.fslregister.nii...
Mov determinant is 5.02197
Swapping dims for pos det
WARNING:: Flipping Left/Right orientation (as det < 0)
tkregister_tcl /software/freesurfer/freesurfer-6.0.0/tktools/tkregister2.tcl
target  volume ./tmp.bbregister.8760/fslregister/movvol.fslregister.nii
movable volume ./tmp.bbregister.8760/template.nii
reg file       ./tmp.bbregister.8760/fslregister/swapreg.dat
LoadVol        0
ZeroCRAS       0
$Id: tkregister2.c,v 1.132.2.1 2016/08/02 21:17:29 greve Exp $
Diagnostic Level -1
INFO: loading target ./tmp.bbregister.8760/fslregister/movvol.fslregister.nii
INFO: target does not conform to COR format, so I'm going to
reslice to COR. This will not affect the final registration.
Ttarg: --------------------
-1.00000   0.00000   0.00000   128.00000;
 0.00000   0.00000   1.00000  -128.00000;
 0.00000  -1.00000   0.00000   128.00000;
 0.00000   0.00000   0.00000   1.00000;
INFO: loading movable ./tmp.bbregister.8760/template.nii
Tmov: --------------------
-1.71875   0.00000   0.00000   110.00000;
 0.00000   0.00000   1.70000  -76.50000;
 0.00000  -1.71875   0.00000   110.00000;
 0.00000   0.00000   0.00000   1.00000;
mkheaderreg = 1, float2int = 0
Computing reg from header (and possibly input matrix)
---- Input registration matrix (computed) --------
-0.99668   0.05188   0.06281   1.71873;
 0.05115  -0.20146   0.97816   0.00000;
-0.06340  -0.97812  -0.19813  -0.00002;
 0.00000   0.00000   0.00000   1.00000;
---------------------------------------
---- Input registration matrix --------
-0.99668   0.05188   0.06281   1.71873;
 0.05115  -0.20146   0.97816   0.00000;
-0.06340  -0.97812  -0.19813  -0.00002;
 0.00000   0.00000   0.00000   1.00000;
Determinant -1
subject = subject-unknown
RegMat ---------------------------
-1.00000  -0.00000   0.00000   1.71873;
-0.00000   1.00000  -0.00000   0.00001;
 0.00000   0.00000   1.00000  -0.00003;
 0.00000   0.00000   0.00000   1.00000;
/mnt/lustre/working/lab_michaebr/alistaiP/Park/Diff/Patient_063/preproc
tkregister2_cmdl --mov ./tmp.bbregister.8760/fslregister/movvol.fslregister.nii --reg ./tmp.bbregister.8760/fslregister/reg0.8800.dat --regheader --fslregout ./tmp.bbregister.8760/reg.init.dat.fsl.mat0 --s Patient_063 --noedit
tkregister_tcl /software/freesurfer/freesurfer-6.0.0/tktools/tkregister2.tcl
INFO: no target volume specified, assuming FreeSurfer orig volume.
target  volume orig
movable volume ./tmp.bbregister.8760/fslregister/movvol.fslregister.nii
reg file       ./tmp.bbregister.8760/fslregister/reg0.8800.dat
LoadVol        0
ZeroCRAS       0
$Id: tkregister2.c,v 1.132.2.1 2016/08/02 21:17:29 greve Exp $
Diagnostic Level -1
INFO: loading target /working/lab_michaebr/alistaiP/Park/FS/Patient_063/mri/orig.mgz
Ttarg: --------------------
-1.00000   0.00000   0.00000   128.00000;
 0.00000   0.00000   1.00000  -128.00000;
 0.00000  -1.00000   0.00000   128.00000;
 0.00000   0.00000   0.00000   1.00000;
INFO: loading movable ./tmp.bbregister.8760/fslregister/movvol.fslregister.nii
Tmov: --------------------
-1.71875   0.00000   0.00000   110.00000;
 0.00000   0.00000   1.70000  -76.50000;
 0.00000  -1.71875   0.00000   110.00000;
 0.00000   0.00000   0.00000   1.00000;
mkheaderreg = 1, float2int = 0
Computing reg from header (and possibly input matrix)
---- Input registration matrix (computed) --------
 0.99668  -0.05188  -0.06281   0.78243;
 0.05115  -0.20146   0.97816   0.28069;
-0.06340  -0.97812  -0.19813  -12.12904;
 0.00000   0.00000   0.00000   1.00000;
---------------------------------------
---- Input registration matrix --------
 0.99668  -0.05188  -0.06281   0.78243;
 0.05115  -0.20146   0.97816   0.28069;
-0.06340  -0.97812  -0.19813  -12.12904;
 0.00000   0.00000   0.00000   1.00000;
Determinant 1
subject = Patient_063
RegMat ---------------------------
 0.99668  -0.05188  -0.06281   0.78243;
 0.05115  -0.20146   0.97816   0.28069;
-0.06340  -0.97812  -0.19813  -12.12904;
 0.00000   0.00000   0.00000   1.00000;
FSLOUTPUTTYPE NIFTI 
tkreg2FSL: mov det = -5.02197, ref det = -1
Sat Mar 18 04:08:02 AEST 2017
/mnt/lustre/working/lab_michaebr/alistaiP/Park/Diff/Patient_063/preproc
flirt.fsl -ref ./tmp.bbregister.8760/fslregister/refvol.fslregister.nii -in ./tmp.bbregister.8760/fslregister/movvol.fslregister.nii -bins 256 -cost corratio -dof 6 -searchrx -90 90 -searchry -90 90 -searchrz -90 90 -verbose 0 -omat ./tmp.bbregister.8760/fslregister/fslmat0.trans.mat -schedule /software/freesurfer/freesurfer-6.0.0/bin/fsl.5.0.2.xyztrans.sch -init ./tmp.bbregister.8760/reg.init.dat.fsl.mat0
Sat Mar 18 04:08:25 AEST 2017
/mnt/lustre/working/lab_michaebr/alistaiP/Park/Diff/Patient_063/preproc
flirt.fsl -ref ./tmp.bbregister.8760/fslregister/refvol.fslregister.nii -in ./tmp.bbregister.8760/fslregister/movvol.fslregister.nii -bins 256 -cost corratio -dof 6 -searchrx -90 90 -searchry -90 90 -searchrz -90 90 -verbose 0 -omat ./tmp.bbregister.8760/reg.init.dat.fsl.mat -init ./tmp.bbregister.8760/fslregister/fslmat0.trans.mat -schedule /software/freesurfer/freesurfer-6.0.0/bin/flirt.newdefault.20080811.sch
tkregister2_cmdl --s Patient_063 --mov ./tmp.bbregister.8760/fslregister/movvol.fslregister.nii --reg ./tmp.bbregister.8760/reg.init.dat --fslreg ./tmp.bbregister.8760/reg.init.dat.fsl.mat --noedit
tkregister_tcl /software/freesurfer/freesurfer-6.0.0/tktools/tkregister2.tcl
---- FSL registration matrix --------
 0.99472  -0.07633  -0.06856   32.83940;
-0.08313  -0.20798  -0.97459   238.20100;
 0.06013   0.97515  -0.21323   19.08820;
 0.00000   0.00000   0.00000   1.00000;
---------------------------------------
INFO: no target volume specified, assuming FreeSurfer orig volume.
target  volume orig
movable volume ./tmp.bbregister.8760/fslregister/movvol.fslregister.nii
reg file       ./tmp.bbregister.8760/reg.init.dat
LoadVol        0
ZeroCRAS       0
$Id: tkregister2.c,v 1.132.2.1 2016/08/02 21:17:29 greve Exp $
Diagnostic Level -1
INFO: loading target /working/lab_michaebr/alistaiP/Park/FS/Patient_063/mri/orig.mgz
Ttarg: --------------------
-1.00000   0.00000   0.00000   128.00000;
 0.00000   0.00000   1.00000  -128.00000;
 0.00000  -1.00000   0.00000   128.00000;
 0.00000   0.00000   0.00000   1.00000;
INFO: loading movable ./tmp.bbregister.8760/fslregister/movvol.fslregister.nii
Tmov: --------------------
-1.71875   0.00000   0.00000   110.00000;
 0.00000   0.00000   1.70000  -76.50000;
 0.00000  -1.71875   0.00000   110.00000;
 0.00000   0.00000   0.00000   1.00000;
mkheaderreg = 0, float2int = 0
FSLOUTPUTTYPE NIFTI 
fsl2TkReg: mov det = -5.02197, ref det = -1
---- Input registration matrix (computed) --------
 0.99472  -0.06013  -0.08313  -0.36824;
 0.06856  -0.21323   0.97459   1.15335;
-0.07633  -0.97515  -0.20799  -11.86227;
 0.00000   0.00000   0.00000   1.00000;
---------------------------------------
---- Input registration matrix --------
 0.99472  -0.06013  -0.08313  -0.36824;
 0.06856  -0.21323   0.97459   1.15335;
-0.07633  -0.97515  -0.20799  -11.86227;
 0.00000   0.00000   0.00000   1.00000;
Determinant 1
subject = Patient_063
RegMat ---------------------------
 0.99472  -0.06013  -0.08313  -0.36824;
 0.06856  -0.21323   0.97459   1.15335;
-0.07633  -0.97515  -0.20799  -11.86227;
 0.00000   0.00000   0.00000   1.00000;
mri_matrix_multiply -im ./tmp.bbregister.8760/fslregister/swapreg.dat -im ./tmp.bbregister.8760/reg.init.dat -om ./tmp.bbregister.8760/reg.init.dat
(standard_in) 1: illegal character: P
 
Started at Sat Mar 18 04:07:59 AEST 2017 
Ended   at Sat Mar 18 04:09:12 AEST 2017
 
fslregister Done
 
To check results, run:
tkregister2 --mov ./tmp.bbregister.8760/template.nii --reg ./tmp.bbregister.8760/reg.init.dat --surf orig
 
mri_segreg --mov ./tmp.bbregister.8760/template.nii --init-reg ./tmp.bbregister.8760/reg.init.dat --out-reg ./tmp.bbregister.8760/bbr.pass1.dat --subsamp-brute 100 --subsamp 100 --tol 1e-4 --tol1d 1e-3 --brute -4 4 4 --surf white --gm-proj-frac 0.5 --gm-gt-wm 0.5
$Id: mri_segreg.c,v 1.113 2016/05/10 03:23:20 greve Exp $
setenv SUBJECTS_DIR /working/lab_michaebr/alistaiP/Park/FS
cd /mnt/lustre/working/lab_michaebr/alistaiP/Park/Diff/Patient_063/preproc
mri_segreg --mov ./tmp.bbregister.8760/template.nii --init-reg ./tmp.bbregister.8760/reg.init.dat --out-reg ./tmp.bbregister.8760/bbr.pass1.dat --subsamp-brute 100 --subsamp 100 --tol 1e-4 --tol1d 1e-3 --brute -4 4 4 --surf white --gm-proj-frac 0.5 --gm-gt-wm 0.5 
sysname  Linux
hostname hpcnode031.adqimr.ad.lan
machine  x86_64
user     alistaiP
movvol ./tmp.bbregister.8760/template.nii
regfile ./tmp.bbregister.8760/reg.init.dat
subject Patient_063
dof 6
outregfile ./tmp.bbregister.8760/bbr.pass1.dat
UseMask 0
UseLH 1
UseRH 1
nsubsamp 100
PenaltySign  -1
PenaltySlope 0.500000
PenaltyCenter 0.000000
surfname white
GMProjFrac 0.500000
WMProjAbs 2.000000
lhcostfile (null)
rhcostfile (null)
interp  trilinear (1)
frame  0
TolPowell 0.000100
nMaxItersPowell 36
n1dmin  3
Profile   0
Gdiag_no  -1
AddNoise  0 (0)
SynthSeed 1490246551
TransRandMax 0.000000
RotRandMax 0.000000
Translations 0.000000 0.000000 0.000000
Rotations   0.000000 0.000000 0.000000
Input reg
-0.99472   0.06013   0.08313   2.08697;
 0.06856  -0.21323   0.97459   1.15337;
-0.07633  -0.97515  -0.20799  -11.86230;
 0.00000   0.00000   0.00000   1.00000;

Loading mov
Projecting LH Surfs
Loading lh.white surf
Loading lh.thickness for GM
GM Proj: 1 0.500000 2.000000
WM Proj: 0 0.500000 2.000000
Projecting RH Surfs
Loading rh.white surf
Loading rh.thickness for GM
Projecting RH Surfs
Using lh.cortex.label
Using rh.cortex.label
Computing relative cost
 0  -25.0 -25.0 -25.0   0.987056
 1  -25.0 -25.0  25.0   0.980594
 2  -25.0  25.0 -25.0   0.974812
 3  -25.0  25.0  25.0   0.968050
 4   25.0 -25.0 -25.0   0.997763
 5   25.0 -25.0  25.0   0.998851
 6   25.0  25.0 -25.0   0.984249
 7   25.0  25.0  25.0   0.957718
REL:  8  0.155001    7.849092  0.981137 rel = 0.157981 
Initial costs ----------------
Number of surface hits 2834
WM  Intensity   367.2739 +/-  91.6653
Ctx Intensity   563.3988 +/- 161.0772
Pct Contrast     39.6463 +/-  30.9688
Cost   0.1550
RelCost   0.1580

------------------------------------
Brute force preopt -4 4 4, n = 729
     0  -4.0000  -4.0000  -4.0000  -4.0000  -4.0000  -4.0000      0.9926   0.9926  0.0
     2  -4.0000  -4.0000  -4.0000  -4.0000  -4.0000   4.0000      0.9581   0.9581  0.0
     7  -4.0000  -4.0000  -4.0000  -4.0000   4.0000   0.0000      0.8777   0.8777  0.0
    15  -4.0000  -4.0000  -4.0000   0.0000   4.0000  -4.0000      0.8312   0.8312  0.0
    34  -4.0000  -4.0000   0.0000  -4.0000   4.0000   0.0000      0.8001   0.8001  0.0
   118  -4.0000   0.0000   0.0000   0.0000  -4.0000   0.0000      0.7969   0.7969  0.0
   120  -4.0000   0.0000   0.0000   0.0000   0.0000  -4.0000      0.7534   0.7534  0.0
   265   0.0000  -4.0000  -4.0000   4.0000   0.0000   0.0000      0.7359   0.7359  0.0
   274   0.0000  -4.0000   0.0000  -4.0000   0.0000   0.0000      0.6639   0.6639  0.0
   363   0.0000   0.0000   0.0000   0.0000   0.0000  -4.0000      0.6240   0.6240  0.0
   364   0.0000   0.0000   0.0000   0.0000   0.0000   0.0000      0.1550   0.1550  0.0
Brute Force --------------------------
Min cost was 0.155001
Number of iterations   729
Search time 2.284000 sec
Parameters at best (transmm, rotdeg)
  0.000   0.000   0.000  0.000  0.000  0.000 
--------------------------------------------

Starting Powell Minimization
Init Powel Params dof = 6
0 0
1 0
2 0
3 0
4 0
5 0
fs_powell::minimize
  nparams 6
  maxfev 36
  ftol   0.000100
  linmin_xtol_   0.001000
  powell nthiter 0: fret = 0.155001
  10 -0.014  0.000  0.000  0.000  0.000  0.000   0.1548397257
  11 -0.016  0.000  0.000  0.000  0.000  0.000   0.1548166315
  13 -0.018  0.000  0.000  0.000  0.000  0.000   0.1548099055
  15 -0.017  0.000  0.000  0.000  0.000  0.000   0.1548081616
  18 -0.017 -1.618  0.000  0.000  0.000  0.000   0.1334199686
  19 -0.017 -0.890  0.000  0.000  0.000  0.000   0.0821485631
  23 -0.017 -0.812  0.000  0.000  0.000  0.000   0.0797616238
  25 -0.017 -0.811  0.000  0.000  0.000  0.000   0.0797347676
  26 -0.017 -0.800  0.000  0.000  0.000  0.000   0.0796138827
  28 -0.017 -0.798  0.000  0.000  0.000  0.000   0.0796060944
  29 -0.017 -0.797  0.000  0.000  0.000  0.000   0.0796054493
  39 -0.017 -0.797  0.014  0.000  0.000  0.000   0.0795118929
  40 -0.017 -0.797  0.016  0.000  0.000  0.000   0.0795117397
  42 -0.017 -0.797  0.015  0.000  0.000  0.000   0.0795111462
  52 -0.017 -0.797  0.015  0.005  0.000  0.000   0.0794902385
  64 -0.017 -0.797  0.015  0.005  0.007  0.000   0.0794205294
  66 -0.017 -0.797  0.015  0.005  0.009  0.000   0.0794143312
  67 -0.017 -0.797  0.015  0.005  0.010  0.000   0.0794141802
  74 -0.017 -0.797  0.015  0.005  0.010  0.382   0.0723617800
  76 -0.017 -0.797  0.015  0.005  0.010  0.374   0.0723089758
  77 -0.017 -0.797  0.015  0.005  0.010  0.353   0.0722929105
  79 -0.017 -0.797  0.015  0.005  0.010  0.361   0.0722829158
  80 -0.017 -0.797  0.015  0.005  0.010  0.360   0.0722826472
  89 -0.017 -0.794  0.015  0.005  0.010  0.359   0.0722474086
  90 -0.016 -0.731  0.014  0.005  0.009  0.330   0.0721455529
  92 -0.016 -0.758  0.014  0.005  0.009  0.343   0.0719023771
  94 -0.016 -0.748  0.014  0.005  0.009  0.338   0.0718293518
  96 -0.016 -0.750  0.014  0.005  0.009  0.339   0.0718171127
  97 -0.016 -0.751  0.014  0.005  0.009  0.339   0.0718159004
  powell nthiter 1: fret = 0.071816
 107 -0.077 -0.751  0.014  0.005  0.009  0.339   0.0712319152
 110 -0.084 -0.751  0.014  0.005  0.009  0.339   0.0711100471
 122 -0.084 -0.751  0.014  0.005  0.009  0.338   0.0711054435
 123 -0.084 -0.751  0.014  0.005  0.009  0.337   0.0711049544
 132 -0.084 -0.751  0.062  0.005  0.009  0.337   0.0702110173
 136 -0.084 -0.751  0.059  0.005  0.009  0.337   0.0701900851
 137 -0.084 -0.751  0.053  0.005  0.009  0.337   0.0701883586
 139 -0.084 -0.751  0.055  0.005  0.009  0.337   0.0701837092
 151 -0.084 -0.751  0.055  0.016  0.009  0.337   0.0700973039
 152 -0.084 -0.751  0.055  0.015  0.009  0.337   0.0700969075
 164 -0.084 -0.751  0.055  0.015  0.010  0.337   0.0700967929
 175 -0.084 -0.753  0.055  0.015  0.010  0.338   0.0700845074
 176 -0.084 -0.754  0.055  0.015  0.010  0.338   0.0700838707
  powell nthiter 2: fret = 0.070084
 190 -0.090 -0.754  0.055  0.015  0.010  0.338   0.0700538102
 191 -0.088 -0.754  0.055  0.015  0.010  0.338   0.0700442274
 201 -0.088 -0.754  0.055  0.015  0.010  0.331   0.0699951975
 237 -0.088 -0.754  0.055  0.015  0.011  0.331   0.0699912961
 249 -0.088 -0.756  0.055  0.015  0.012  0.332   0.0699835899
 250 -0.088 -0.757  0.055  0.015  0.012  0.332   0.0699833900
 252 -0.092 -0.759  0.056  0.015  0.013  0.326   0.0699328950
 257 -0.094 -0.761  0.056  0.015  0.014  0.322   0.0699260735
 259 -0.094 -0.761  0.056  0.015  0.013  0.322   0.0699257566
 261 -0.094 -0.761  0.056  0.015  0.013  0.323   0.0699255427
 263 -0.094 -0.761  0.056  0.015  0.013  0.323   0.0699255427
 268 -0.094 -0.761  0.056  0.015  0.013  0.323   0.0699254258
  powell nthiter 3: fret = 0.069925
 307 -0.094 -0.761  0.058  0.015  0.013  0.323   0.0699221763
 340 -0.094 -0.761  0.058  0.015  0.014  0.322   0.0699220445
 346 -0.094 -0.761  0.058  0.015  0.014  0.322   0.0699219501
Powell done niters = 3
Computing relative cost
 0  -25.0 -25.0 -25.0   0.966692
 1  -25.0 -25.0  25.0   0.974620
 2  -25.0  25.0 -25.0   0.972314
 3  -25.0  25.0  25.0   0.980099
 4   25.0 -25.0 -25.0   0.987604
 5   25.0 -25.0  25.0   0.974969
 6   25.0  25.0 -25.0   0.992513
 7   25.0  25.0  25.0   0.961076
REL:  8  0.069922    7.809887  0.976236 rel = 0.071624 
Number of iterations     3
Min cost was 0.069922
Number of FunctionCalls   347
TolPowell 0.000100
nMaxItersPowell 36
OptimizationTime 1.060000 sec
Parameters at optimum (transmm) -0.09424 -0.76110  0.05761
Parameters at optimum (rotdeg)  0.01505  0.01360  0.32190 
Final costs ----------------
Number of surface hits 2834
WM  Intensity   358.3298 +/-  79.1225
Ctx Intensity   550.7847 +/- 120.6487
Pct Contrast     41.2674 +/-  24.9972
Cost   0.0699
RelCost   0.1580
Reg at min cost was 
-0.99511   0.06109   0.07761   1.98338;
 0.06299  -0.21264   0.97510   0.40707;
-0.07607  -0.97522  -0.20775  -11.80488;
 0.00000   0.00000   0.00000   1.00000;

Writing optimal reg to ./tmp.bbregister.8760/bbr.pass1.dat, type = 14 
Original Reg 
-0.99472   0.06013   0.08313   2.08697;
 0.06856  -0.21323   0.97459   1.15337;
-0.07633  -0.97515  -0.20799  -11.86230;
 0.00000   0.00000   0.00000   1.00000;

Original Reg - Optimal Reg
 0.00039  -0.00096   0.00553   0.10359;
 0.00557  -0.00060  -0.00051   0.74630;
-0.00025   0.00007  -0.00024  -0.05742;
 0.00000   0.00000   0.00000   0.00000;

Computing change in lh position
LH rmsDiffMean 0.629069
Computing change in rh position
Surface-RMS-Diff-mm 0.781770 0.180699 1.129230
mri_segreg done
mri_segreg --mov ./tmp.bbregister.8760/template.nii --init-reg ./tmp.bbregister.8760/bbr.pass1.dat --out-reg register.dat --interp trilinear --wm-proj-abs 2 --tol 1e-8 --tol1d 1e-3 --c0 0 --mincost register.dat.mincost --dof 6 --nmax 36 --param register.dat.param --surf white --brute -0.1 0.1 0.1 --cur-reg ./tmp.bbregister.8760/reg.curopt.dat --gm-proj-frac 0.5 --nsub 1 --gm-gt-wm 0.5
$Id: mri_segreg.c,v 1.113 2016/05/10 03:23:20 greve Exp $
setenv SUBJECTS_DIR /working/lab_michaebr/alistaiP/Park/FS
cd /mnt/lustre/working/lab_michaebr/alistaiP/Park/Diff/Patient_063/preproc
mri_segreg --mov ./tmp.bbregister.8760/template.nii --init-reg ./tmp.bbregister.8760/bbr.pass1.dat --out-reg register.dat --interp trilinear --wm-proj-abs 2 --tol 1e-8 --tol1d 1e-3 --c0 0 --mincost register.dat.mincost --dof 6 --nmax 36 --param register.dat.param --surf white --brute -0.1 0.1 0.1 --cur-reg ./tmp.bbregister.8760/reg.curopt.dat --gm-proj-frac 0.5 --nsub 1 --gm-gt-wm 0.5 
sysname  Linux
hostname hpcnode031.adqimr.ad.lan
machine  x86_64
user     alistaiP
movvol ./tmp.bbregister.8760/template.nii
regfile ./tmp.bbregister.8760/bbr.pass1.dat
subject Patient_063
dof 6
outregfile register.dat
UseMask 0
UseLH 1
UseRH 1
nsubsamp 1
PenaltySign  -1
PenaltySlope 0.500000
PenaltyCenter 0.000000
surfname white
GMProjFrac 0.500000
WMProjAbs 2.000000
lhcostfile (null)
rhcostfile (null)
interp  trilinear (1)
frame  0
TolPowell 0.000000
nMaxItersPowell 36
n1dmin  3
Profile   0
Gdiag_no  -1
AddNoise  0 (0)
SynthSeed 1490489350
TransRandMax 0.000000
RotRandMax 0.000000
Translations 0.000000 0.000000 0.000000
Rotations   0.000000 0.000000 0.000000
Input reg
-0.99511   0.06109   0.07761   1.98338;
 0.06299  -0.21264   0.97510   0.40707;
-0.07607  -0.97522  -0.20775  -11.80488;
 0.00000   0.00000   0.00000   1.00000;

Loading mov
Projecting LH Surfs
Loading lh.white surf
Loading lh.thickness for GM
GM Proj: 1 0.500000 2.000000
WM Proj: 0 0.500000 2.000000
Projecting RH Surfs
Loading rh.white surf
Loading rh.thickness for GM
Projecting RH Surfs
Using lh.cortex.label
Using rh.cortex.label
Computing relative cost
 0  -25.0 -25.0 -25.0   0.995913
 1  -25.0 -25.0  25.0   1.002387
 2  -25.0  25.0 -25.0   0.980450
 3  -25.0  25.0  25.0   1.004656
 4   25.0 -25.0 -25.0   0.991628
 5   25.0 -25.0  25.0   0.990971
 6   25.0  25.0 -25.0   1.001260
 7   25.0  25.0  25.0   0.990001
REL:  8  0.078281    7.957265  0.994658 rel = 0.0787014 
Initial costs ----------------
Number of surface hits 283244
WM  Intensity   358.4963 +/-  78.3778
Ctx Intensity   550.6243 +/- 118.5003
Pct Contrast     41.2102 +/-  25.5613
Cost   0.0783
RelCost   0.0787

------------------------------------
Brute force preopt -0.1 0.1 0.1, n = 729
     0  -0.1000  -0.1000  -0.1000  -0.1000  -0.1000  -0.1000      0.0795   0.0795  0.0
     1  -0.1000  -0.1000  -0.1000  -0.1000  -0.1000   0.0000      0.0792   0.0792  0.0
     3  -0.1000  -0.1000  -0.1000  -0.1000   0.0000  -0.1000      0.0774   0.0774  0.0
     6  -0.1000  -0.1000  -0.1000  -0.1000   0.1000  -0.1000      0.0772   0.0772  0.0
     7  -0.1000  -0.1000  -0.1000  -0.1000   0.1000   0.0000      0.0770   0.0770  0.0
     9  -0.1000  -0.1000  -0.1000   0.0000  -0.1000  -0.1000      0.0768   0.0768  0.0
    10  -0.1000  -0.1000  -0.1000   0.0000  -0.1000   0.0000      0.0764   0.0764  0.0
    12  -0.1000  -0.1000  -0.1000   0.0000   0.0000  -0.1000      0.0759   0.0759  0.0
    15  -0.1000  -0.1000  -0.1000   0.0000   0.1000  -0.1000      0.0754   0.0754  0.0
    39  -0.1000  -0.1000   0.0000   0.0000   0.0000  -0.1000      0.0743   0.0743  0.0
   120  -0.1000   0.0000   0.0000   0.0000   0.0000  -0.1000      0.0738   0.0738  0.0
   254   0.0000  -0.1000  -0.1000   0.0000  -0.1000   0.1000      0.0735   0.0735  0.0
   258   0.0000  -0.1000  -0.1000   0.0000   0.1000  -0.1000      0.0723   0.0723  0.0
   267   0.0000  -0.1000  -0.1000   0.1000   0.1000  -0.1000      0.0722   0.0722  0.0
   283   0.0000  -0.1000   0.0000   0.0000   0.0000   0.0000      0.0719   0.0719  0.0
   285   0.0000  -0.1000   0.0000   0.0000   0.1000  -0.1000      0.0715   0.0715  0.0
   364   0.0000   0.0000   0.0000   0.0000   0.0000   0.0000      0.0699   0.0699  0.0
Brute Force --------------------------
Min cost was 0.069922
Number of iterations   729
Search time 2.210000 sec
Parameters at best (transmm, rotdeg)
  0.000   0.000   0.000  0.000  0.000  0.000 
--------------------------------------------

Starting Powell Minimization
Init Powel Params dof = 6
0 0
1 0
2 0
3 0
4 0
5 0
fs_powell::minimize
  nparams 6
  maxfev 36
  ftol   0.000000
  linmin_xtol_   0.001000
  powell nthiter 0: fret = 0.078281
   7  0.070  0.000  0.000  0.000  0.000  0.000   0.0776735195
   8  0.072  0.000  0.000  0.000  0.000  0.000   0.0776692591
  11  0.071  0.000  0.000  0.000  0.000  0.000   0.0776677694
  18  0.071 -0.116  0.000  0.000  0.000  0.000   0.0767136946
  20  0.071 -0.109  0.000  0.000  0.000  0.000   0.0767134345
  21  0.071 -0.111  0.000  0.000  0.000  0.000   0.0767133217
  22  0.071 -0.112  0.000  0.000  0.000  0.000   0.0767132712
  23  0.071 -0.114  0.000  0.000  0.000  0.000   0.0767132506
  31  0.071 -0.114 -0.058  0.000  0.000  0.000   0.0762513682
  32  0.071 -0.114 -0.097  0.000  0.000  0.000   0.0761469613
  34  0.071 -0.114 -0.096  0.000  0.000  0.000   0.0761402510
  50  0.071 -0.114 -0.096  0.001  0.000  0.000   0.0761392836
  58  0.071 -0.114 -0.096  0.001 -0.057  0.000   0.0760006128
  59  0.071 -0.114 -0.096  0.001 -0.039  0.000   0.0759884337
  60  0.071 -0.114 -0.096  0.001 -0.044  0.000   0.0759863304
  70  0.071 -0.114 -0.096  0.001 -0.044 -0.010   0.0759802096
  72  0.071 -0.114 -0.096  0.001 -0.044 -0.011   0.0759801837
  powell nthiter 1: fret = 0.075980
  82  0.073 -0.114 -0.096  0.001 -0.044 -0.011   0.0759774320
  83  0.079 -0.114 -0.096  0.001 -0.044 -0.011   0.0759720141
  84  0.080 -0.114 -0.096  0.001 -0.044 -0.011   0.0759716940
  85  0.082 -0.114 -0.096  0.001 -0.044 -0.011   0.0759714130
  94  0.082 -0.106 -0.096  0.001 -0.044 -0.011   0.0759560300
  95  0.082 -0.099 -0.096  0.001 -0.044 -0.011   0.0759480563
  97  0.082 -0.092 -0.096  0.001 -0.044 -0.011   0.0759452134
 109  0.082 -0.092 -0.097  0.001 -0.044 -0.011   0.0759449213
 118  0.082 -0.092 -0.097  0.000 -0.044 -0.011   0.0759444118
 119  0.082 -0.092 -0.097 -0.004 -0.044 -0.011   0.0759427604
 123  0.082 -0.092 -0.097 -0.006 -0.044 -0.011   0.0759422453
 124  0.082 -0.092 -0.097 -0.007 -0.044 -0.011   0.0759421741
 134  0.082 -0.092 -0.097 -0.007 -0.045 -0.011   0.0759421346
 143  0.082 -0.092 -0.097 -0.007 -0.045 -0.003   0.0759388436
 145  0.082 -0.092 -0.097 -0.007 -0.045 -0.002   0.0759387972
  powell nthiter 2: fret = 0.075939
 165  0.082 -0.097 -0.097 -0.007 -0.045 -0.002   0.0759385344
 166  0.082 -0.095 -0.097 -0.007 -0.045 -0.002   0.0759382093
 176  0.082 -0.095 -0.094 -0.007 -0.045 -0.002   0.0759329289
 194  0.082 -0.095 -0.094 -0.009 -0.045 -0.002   0.0759327357
 203  0.082 -0.095 -0.094 -0.009 -0.050 -0.002   0.0759323363
 204  0.082 -0.095 -0.094 -0.009 -0.048 -0.002   0.0759319502
 223  0.082 -0.094 -0.095 -0.009 -0.047 -0.002   0.0759316134
 224  0.082 -0.094 -0.095 -0.008 -0.047 -0.002   0.0759315728
 226  0.082 -0.094 -0.095 -0.009 -0.047 -0.002   0.0759314837
 232  0.082 -0.094 -0.095 -0.009 -0.047 -0.002   0.0759314626
  powell nthiter 3: fret = 0.075931
 251  0.082 -0.095 -0.095 -0.009 -0.047 -0.002   0.0759313478
  powell nthiter 4: fret = 0.075931
Powell done niters = 4
Computing relative cost
 0  -25.0 -25.0 -25.0   0.995725
 1  -25.0 -25.0  25.0   1.002202
 2  -25.0  25.0 -25.0   0.980198
 3  -25.0  25.0  25.0   1.003204
 4   25.0 -25.0 -25.0   0.992087
 5   25.0 -25.0  25.0   0.992697
 6   25.0  25.0 -25.0   1.002239
 7   25.0  25.0  25.0   0.990265
REL:  8  0.075931    7.958618  0.994827 rel = 0.0763262 
Number of iterations     4
Min cost was 0.075931
Number of FunctionCalls   373
TolPowell 0.000000
nMaxItersPowell 36
OptimizationTime 42.140000 sec
Parameters at optimum (transmm)  0.08228 -0.09506 -0.09512
Parameters at optimum (rotdeg) -0.00850 -0.04719 -0.00248 
Final costs ----------------
Number of surface hits 283246
WM  Intensity   358.2080 +/-  77.8018
Ctx Intensity   549.3661 +/- 115.7528
Pct Contrast     41.1646 +/-  25.0761
Cost   0.0759
RelCost   0.0787
Reg at min cost was 
-0.99504   0.06189   0.07782   2.07540;
 0.06302  -0.21278   0.97506   0.31017;
-0.07690  -0.97514  -0.20783  -11.89842;
 0.00000   0.00000   0.00000   1.00000;

Writing optimal reg to register.dat, type = 14 
Original Reg 
-0.99511   0.06109   0.07761   1.98338;
 0.06299  -0.21264   0.97510   0.40707;
-0.07607  -0.97522  -0.20775  -11.80488;
 0.00000   0.00000   0.00000   1.00000;

Original Reg - Optimal Reg
-0.00007  -0.00079  -0.00021  -0.09201;
-0.00003   0.00015   0.00003   0.09690;
 0.00083  -0.00008   0.00008   0.09354;
 0.00000   0.00000   0.00000   0.00000;

Computing change in lh position
LH rmsDiffMean 0.140974
Computing change in rh position
Surface-RMS-Diff-mm 0.154840 0.025987 0.214119
mri_segreg done
MinCost: 0.075931 358.208047 549.366071 41.164592 
tkregister2_cmdl --mov biasmeanb0bet.nii.gz --reg register.dat --noedit --fslregout diff2FS.mat
tkregister_tcl /software/freesurfer/freesurfer-6.0.0/tktools/tkregister2.tcl
INFO: no target volume specified, assuming FreeSurfer orig volume.
target  volume orig
movable volume biasmeanb0bet.nii.gz
reg file       register.dat
LoadVol        0
ZeroCRAS       0
$Id: tkregister2.c,v 1.132.2.1 2016/08/02 21:17:29 greve Exp $
Diagnostic Level -1
---- Input registration matrix --------
-0.99504   0.06189   0.07782   2.07540;
 0.06302  -0.21278   0.97506   0.31017;
-0.07690  -0.97514  -0.20783  -11.89842;
 0.00000   0.00000   0.00000   1.00000;
float2int = 0
---------------------------------------
INFO: loading target /working/lab_michaebr/alistaiP/Park/FS/Patient_063/mri/orig.mgz
Ttarg: --------------------
-1.00000   0.00000   0.00000   128.00000;
 0.00000   0.00000   1.00000  -128.00000;
 0.00000  -1.00000   0.00000   128.00000;
 0.00000   0.00000   0.00000   1.00000;
INFO: loading movable biasmeanb0bet.nii.gz
Tmov: --------------------
-1.71875   0.00000   0.00000   110.00000;
 0.00000   0.00000   1.70000  -76.50000;
 0.00000  -1.71875   0.00000   110.00000;
 0.00000   0.00000   0.00000   1.00000;
mkheaderreg = 0, float2int = 0
---- Input registration matrix --------
-0.99504   0.06189   0.07782   2.07540;
 0.06302  -0.21278   0.97506   0.31017;
-0.07690  -0.97514  -0.20783  -11.89842;
 0.00000   0.00000   0.00000   1.00000;
Determinant -1
subject = Patient_063
RegMat ---------------------------
-0.99504   0.06189   0.07782   2.07540;
 0.06302  -0.21278   0.97506   0.31017;
-0.07690  -0.97514  -0.20783  -11.89842;
 0.00000   0.00000   0.00000   1.00000;
FSLOUTPUTTYPE NIFTI_GZ 
tkreg2FSL: mov det = 5.02197, ref det = -1
INFO: FSL2FreeSurfer: Mov volume is NIFTI with positive det,
      applying LR flip to registration matrix.
Cleaning up
 
Started at Sat Mar 18 04:07:59 AEST 2017 
Ended   at Sat Mar 18 04:10:26 AEST 2017
BBR-Run-Time-Sec 147
 
bbregister Done
To check results, run:
tkregisterfv --mov biasmeanb0bet.nii.gz --reg register.dat --surfs 
 
dwi2response: [03;32m[0m
dwi2response: [03;32mNote that this script makes use of commands / algorithms that have relevant articles for citation. Please consult the help page (-help option) for more information.[0m
dwi2response: [03;32m[0m
dwi2response: [03;32mGenerated temporary directory: /tmp/dwi2response-tmp-35NW1T/[0m
[03;34mCommand:[0m mrconvert /mnt/lustre/working/lab_michaebr/alistaiP/Park/Diff/Patient_063/preproc/biascorr.mif /tmp/dwi2response-tmp-35NW1T/dwi.mif -stride 0,0,0,1
[03;34mCommand:[0m mrconvert /mnt/lustre/working/lab_michaebr/alistaiP/Park/Diff/Patient_063/preproc/biasmeanb0bet_mask.nii.gz /tmp/dwi2response-tmp-35NW1T/mask.mif -datatype bit
dwi2response: [03;32mChanging to temporary directory (/tmp/dwi2response-tmp-35NW1T/)[0m
dwi2response: [03;32m2 unique b-value(s) detected: 0,3000 with 13,90 volumes.[0m
[03;34mCommand:[0m maskfilter mask.mif erode eroded_mask.mif -npass 3
[03;34mCommand:[0m dwiextract dwi.mif -shell 0 dwi_b0.mif
[03;34mCommand:[0m mrmath dwi_b0.mif mean mean_b0.mif -axis 3
[03;34mCommand:[0m mrcalc mean_b0.mif -finite mean_b0.mif 0 -if 0 -le err_b0.mif -datatype bit
[03;34mCommand:[0m dwiextract dwi.mif -shell 3000 dwi_b3000.mif
[03;34mCommand:[0m mrmath dwi_b3000.mif mean mean_b3000.mif -axis 3
[03;34mCommand:[0m mrcalc mean_b3000.mif -finite mean_b3000.mif 0 -if 0 -le err_b3000.mif -datatype bit
[03;34mCommand:[0m mrcalc mean_b0.mif mean_b3000.mif -divide -log sdm_b3000.mif
[03;34mCommand:[0m mrcalc sdm_b3000.mif 90 -mult 90 -divide full_sdm.mif
[03;34mCommand:[0m mrcalc full_sdm.mif -finite full_sdm.mif 0 -if 0 -le err_sdm.mif -datatype bit
[03;34mCommand:[0m mrcalc err_b0.mif err_b3000.mif -add err_sdm.mif -add 0 eroded_mask.mif -if safe_mask.mif -datatype bit
[03;34mCommand:[0m mrcalc safe_mask.mif full_sdm.mif 0 -if 10 -min safe_sdm.mif
[03;34mCommand:[0m dwi2tensor dwi.mif - -mask safe_mask.mif | tensor2metric - -fa safe_fa.mif -vector safe_vecs.mif -modulate none -mask safe_mask.mif
[03;34mCommand:[0m mrcalc safe_mask.mif safe_fa.mif 0 -if 0.2 -gt crude_wm.mif -datatype bit
[03;34mCommand:[0m mrcalc crude_wm.mif 0 safe_mask.mif -if _crudenonwm.mif -datatype bit
[03;34mCommand:[0m mrcalc _crudenonwm.mif safe_sdm.mif 2.32394 -subtract 0 -if - | mrthreshold - - -mask _crudenonwm.mif | mrcalc _crudenonwm.mif - 0 -if crude_csf.mif -datatype bit
[03;34mCommand:[0m mrcalc crude_csf.mif 0 _crudenonwm.mif -if crude_gm.mif -datatype bit
[03;34mCommand:[0m mrcalc crude_wm.mif safe_sdm.mif 0 -if 1.45128 -gt _crudewmhigh.mif -datatype bit
[03;34mCommand:[0m mrcalc _crudewmhigh.mif 0 crude_wm.mif -if _crudewmlow.mif -datatype bit
[03;34mCommand:[0m mrcalc crude_wm.mif safe_sdm.mif 0 -if 1.89931 -gt _crudewmoutliers.mif -datatype bit
[03;34mCommand:[0m mrcalc _crudewmoutliers.mif 0 crude_wm.mif -if refined_wm.mif -datatype bit
[03;34mCommand:[0m mrcalc crude_gm.mif safe_sdm.mif 0 -if 1.93153 -gt _crudegmhigh.mif -datatype bit
[03;34mCommand:[0m mrcalc _crudegmhigh.mif 0 crude_gm.mif -if _crudegmlow.mif -datatype bit
[03;34mCommand:[0m mrcalc _crudegmhigh.mif safe_sdm.mif 1.93153 -subtract 0 -if - | mrthreshold - - -mask _crudegmhigh.mif -invert | mrcalc _crudegmhigh.mif - 0 -if _crudegmhighselect.mif -datatype bit
[03;34mCommand:[0m mrcalc _crudegmlow.mif safe_sdm.mif 1.93153 -subtract -neg 0 -if - | mrthreshold - - -mask _crudegmlow.mif -invert | mrcalc _crudegmlow.mif - 0 -if _crudegmlowselect.mif -datatype bit
[03;34mCommand:[0m mrcalc _crudegmhighselect.mif 1 _crudegmlowselect.mif -if refined_gm.mif -datatype bit
[03;34mCommand:[0m mrcalc _crudewmoutliers.mif safe_sdm.mif 0 -if 2.82828 -gt 1 crude_csf.mif -if _crudecsfextra.mif -datatype bit
[03;34mCommand:[0m mrcalc _crudecsfextra.mif safe_sdm.mif 2.82828 -subtract 0 -if - | mrthreshold - - -mask _crudecsfextra.mif | mrcalc _crudecsfextra.mif - 0 -if refined_csf.mif -datatype bit
dwi2response: [03;32mRunning 'tournier' algorithm to select 604 single-fibre WM voxels.[0m
[03;34mCommand:[0m dwi2response tournier dwi.mif _respsfwmss.txt -sf_voxels 604 -iter_voxels 6040 -mask refined_wm.mif -voxels voxels_sfwm.mif -quiet -tempdir /tmp/dwi2response-tmp-35NW1T/
[03;34mCommand:[0m mrcalc refined_gm.mif safe_sdm.mif 0 -if 1.9206 -gt _refinedgmhigh.mif -datatype bit
[03;34mCommand:[0m mrcalc _refinedgmhigh.mif 0 refined_gm.mif -if _refinedgmlow.mif -datatype bit
[03;34mCommand:[0m mrcalc _refinedgmhigh.mif safe_sdm.mif 0 -if - | mrthreshold - - -bottom 705 -ignorezero | mrcalc _refinedgmhigh.mif - 0 -if _refinedgmhighselect.mif -datatype bit
[03;34mCommand:[0m mrcalc _refinedgmlow.mif safe_sdm.mif 0 -if - | mrthreshold - - -top 705 -ignorezero | mrcalc _refinedgmlow.mif - 0 -if _refinedgmlowselect.mif -datatype bit
[03;34mCommand:[0m mrcalc _refinedgmhighselect.mif 1 _refinedgmlowselect.mif -if voxels_gm.mif -datatype bit
[03;34mCommand:[0m mrcalc refined_csf.mif safe_sdm.mif 0 -if - | mrthreshold - - -top 3054 -ignorezero | mrcalc refined_csf.mif - 0 -if voxels_csf.mif -datatype bit
dwi2response: [03;32mSummary of voxel counts:[0m
dwi2response: [03;32mMask: 381906 --> 313475 --> 313412[0m
dwi2response: [03;32mWM: 128685 --> 120869 --> 604 (SF)[0m
dwi2response: [03;32mGM: 119975 --> 70481 --> 1410[0m
dwi2response: [03;32mCSF: 64752 --> 30540 --> 3054[0m
[03;34mCommand:[0m amp2sh dwi_b0.mif - | sh2response - voxels_sfwm.mif safe_vecs.mif _respsfwmb0.txt
[03;34mCommand:[0m amp2sh dwi_b3000.mif - | sh2response - voxels_sfwm.mif safe_vecs.mif _respsfwmb3000.txt
[03;34mCommand:[0m mrcat crude_csf.mif crude_gm.mif crude_wm.mif crude.mif -axis 3
[03;34mCommand:[0m mrcat refined_csf.mif refined_gm.mif refined_wm.mif refined.mif -axis 3
[03;34mCommand:[0m mrcat voxels_csf.mif voxels_gm.mif voxels_sfwm.mif voxels.mif -axis 3
dwi2response: [03;32mChanging back to original directory (/mnt/lustre/working/lab_michaebr/alistaiP/Park/Diff/Patient_063/preproc)[0m
dwi2response: [03;32mDeleting temporary directory /tmp/dwi2response-tmp-35NW1T/[0m
